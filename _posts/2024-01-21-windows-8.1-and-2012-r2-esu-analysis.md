---
layout: post
title: Windows 8.1 and Windows Server 2012 R2 ESU Analysis
original_date: 2024-01-21
date: 2025-09-17
---

The original Windows 7 ESU Analysis can be found [here](https://hackandpwn.com/windows-7-esu-analysis).  With the ending of support for Windows 8.1 and Server 2012 R2 in 2023, additional research was conducted to see if similar techniques would work for these operating systems as well.  It was determined that both Windows 8.1 and Windows Server 2012 R2 can be fully patched past the supported period.

There are 2 techniques in getting these Operating Systems up to date with the latest patches.   The first technique is to copy the latest manifest file into the C:\Windows\WinSxS\Manifests folder, apply the Components registry key, and apply the SideBySide registry key.  Then, installing the latest Cumulative Update will be successful.

The easier method, however, is to install the latest Cumulative Update, let it "fail", apply the SideBySide registry key, and retry.  Upon completion, the update will succeed.  Both techniques have been validated on these Operating Systems.

> Important:  You must obtain an ESU license to apply ESU updates.  Details on obtaining an ESU license can be found [here](https://support.microsoft.com/en-us/help/4497181/lifecycle-faq-extended-security-updates).  This research was completed for security vulnerability research purposes only following the [Microsoft Legal Safe Harbor Terms](https://www.microsoft.com/en-us/msrc/bounty-safe-harbor).  Do not try to reproduce without having the required licenses.

> There is no ESU license option for Windows 8.1, so for security purposes if Windows 8.1 must still be used, this is an unsupported way on how to keep it patched against the latest vulnerabilities.  Although the last official patch for Windows 8.1 was January 2023, here is a version of Windows 8.1 fully patched through January 2024.

> <center><img src="/assets/2024-01-21-windows-8.1-and-2012-r2-esu-analysis/01.png"></center>

> Note: June 2025 was the last month Microsoft released patches for that were compatible with Windows 8.1.  Starting July 2025, only Windows Server 2012 R2 versions of the patches will be updated in this post.

### Install The Latest Servicing Stack Update (SSU): Server 2012 R2 - KB5065767 (September 2025) / Windows 8.1 - KB5058529 (May 2025)
Install [Server_2012_R2-KB5065767-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/01_Windows8.1-KB5065767-x64.msu)  or [Windows8.1-KB5058529-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/01_Windows8.1-KB5058529-x64_Win81.msu) and reboot the computer. 

### Install The Latest Monthly Cumulative Update Via Failed Reboot Technique: Server 2012 R2 - KB5065507 (September 2025) / Windows 8.1 - KB5061018 (June 2025)
1. Install [Server_2012_R2-KB5065507-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/02_Windows8.1-KB5065507-x64.msu)  or [Windows8.1-KB5061018-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/02_Windows8.1-KB5061018-x64_Win81.msu) and reboot the computer.  This will result in a failed update and rollback.
2. Apply the  new Windows 8.1 or Server 2012 R2 SideBySide registry key linked below.
3. Install KB5061018 again and reboot the computer.  This will result in a successful update.

### Install The Latest Monthly Cumulative Update Via Manifest/Component Technique: Server 2012 R2 - KB5065507 (September 2025) / Windows 8.1 - KB5061018 (June 2025)
If using the Manifest/Components registry key technique:
1. Copy the manifest file linked below into the C:\Windows\WinSxS\Manifests folder.  This can be done by executing the following commands:
> takeown /f C:\Windows\WinSxS\Manifests /a
>
> icacls C:\Windows\WinSxS\Manifests /grant Everyone:(F)
>
> copy amd64_microsoft-windows-s..edsecurityupdatesai_31bf3856ad364e35_6.3.9600.22774_none_599e604bf64ceda2.manifest C:\Windows\WinSxS\Manifests
>
> or for Windows 8.1:
>
> copy amd64_microsoft-windows-s..edsecurityupdatesai_31bf3856ad364e35_6.3.9600.22620_none_59d06cd9f627ff6a.manifest C:\Windows\WinSxS\Manifests
>
> icacls C:\Windows\WinSxS\Manifests /remove Everyone
>
> icacls C:\Windows\WinSxS\Manifests /setowner "NT SERVICE\TrustedInstaller"
2. Apply the new Windows 8.1 or Server 2012 R2 Components registry key linked below.
3. Apply the new Windows 8.1 or Server 2012 R2 SideBySide registry key linked below.
4. Install [Server_2012_R2-KB5065507-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/02_Windows8.1-KB5065507-x64.msu)  or [Windows8.1-KB5061018-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/02_Windows8.1-KB5061018-x64_Win81.msu).

### Install The Latest .NET 3.5 Update - KB5044012 (October 2024)
Install [Windows8.1-KB5044012-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/03_Windows8.1-KB5044012-x64.msu).

### Install The Latest .NET 4.8 Update: Server 2012 R2 - KB5065752 (September 2025) / Windows 8.1 - KB5055173 (April 2025)
Install [Server_2012_R2-KB5065752-x64.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/02_Windows8.1-KB5065752-x64.msu)  or [Windows8.1-KB5055173-x64-ndp48.msu](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/raw/main/Patches/04_Windows8.1-KB5055173-x64-ndp48_Win81.msu).

### Install The Latest Root Certificate Updates
Finally, the latest Microsoft Root Certificates need to be installed into the Local Computer Trusted Root Authority Certificate Store.  A batch file to automatically install all certificates and revocation lists can be found here: [Import.cmd](https://github.com/HackAndPwn/Windows-7-Patching/blob/master/08_Certs/Import.cmd)

<table style="text-align:center"><colgroup><col width="8%" /><col width="16%" /><col width="50%" /></colgroup>
<thead><tr><th style="text-align:center">Date</th><th style="text-align:center">Type</th><th>Download</th></tr></thead><tbody>
<tr><td>2018-08-02</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/MicRooCerAut2011_2011_03_22.crt">MicRooCerAut2011_2011_03_22.crt</a></td></tr>
<tr><td>2018-08-02</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20ECC%20Product%20Root%20Certificate%20Authority%202018.crt">Microsoft ECC Product Root Certificate Authority 2018.crt</a></td></tr>
<tr><td>2018-08-02</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20ECC%20TS%20Root%20Certificate%20Authority%202018.crt">Microsoft ECC TS Root Certificate Authority 2018.crt</a></td></tr>
<tr><td>2018-08-02</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20Time%20Stamp%20Root%20Certificate%20Authority%202014.crt">Microsoft Time Stamp Root Certificate Authority 2014.crt</a></td></tr>
<tr><td>2020-01-22</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20ECC%20Root%20Certificate%20Authority%202017.crt">Microsoft ECC Root Certificate Authority 2017.crt</a></td></tr>
<tr><td>2020-01-22</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20EV%20ECC%20Root%20Certificate%20Authority%202017.crt">Microsoft EV ECC Root Certificate Authority 2017.crt</a></td></tr>
<tr><td>2020-01-22</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20RSA%20Root%20Certificate%20Authority%202017.crt">Microsoft RSA Root Certificate Authority 2017.crt</a></td></tr>
<tr><td>2020-01-22</td><td>Certificate</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20EV%20RSA%20Root%20Certificate%20Authority%202017.crt">Microsoft EV RSA Root Certificate Authority 2017.crt</a></td></tr>
<tr><td>2025-07-23</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20Time%20Stamp%20Root%20Certificate%20Authority%202014.crl">Microsoft Time Stamp Root Certificate Authority 2014.crl</a></td></tr>
<tr><td>2025-08-16</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20ECC%20Root%20Certificate%20Authority%202017.crl">Microsoft ECC Root Certificate Authority 2017.crl</a></td></tr>
<tr><td>2025-08-16</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20RSA%20Root%20Certificate%20Authority%202017.crl">Microsoft RSA Root Certificate Authority 2017.crl</a></td></tr>
<tr><td>2025-08-18</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/MicRooCerAut_2010-06-23.crl">MicRooCerAut_2010-06-23.crl</a></td></tr>
<tr><td>2025-08-26</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20ECC%20TS%20Root%20Certificate%20Authority%202018.crl">Microsoft ECC TS Root Certificate Authority 2018.crl</a></td></tr>
<tr><td>2025-08-26</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20ECC%20Product%20Root%20Certificate%20Authority%202018.crl">Microsoft ECC Product Root Certificate Authority 2018.crl</a></td></tr>
<tr><td>2025-09-05</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20EV%20RSA%20Root%20Certificate%20Authority%202017.crl">Microsoft EV RSA Root Certificate Authority 2017.crl</a></td></tr>
<tr><td>2025-09-05</td><td>Revocation List</td><td style="text-align:left"><a href="https://github.com/HackAndPwn/Windows-7-Patching/raw/master/08_Certs/Microsoft%20EV%20ECC%20Root%20Certificate%20Authority%202017.crl">Microsoft EV ECC Root Certificate Authority 2017.crl</a></td></tr>
</tbody></table>

### References

These files can all be found on GitHub [here](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis).  See below for specific file links.

> [Windows 8.1 x64 Manifest File KB5061018](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/blob/main/2025_06/amd64_microsoft-windows-s..edsecurityupdatesai_31bf3856ad364e35_6.3.9600.22620_none_59d06cd9f627ff6a.manifest)
>
> [Windows 8.1 x64 Components Registry Key KB5061018](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/blob/main/2025_06/8.1_x64_ComponentsRegistryKey.reg)
>
> [Windows 8.1 SideBySide Registry Key KB5061018](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/blob/main/2025_06/8.1_x64_SideBySideRegistryKey_x64.reg)
>
> [Windows Server 2012 R2 x64 Manifest File KB5065507](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/blob/main/2025_09/amd64_microsoft-windows-s..edsecurityupdatesai_31bf3856ad364e35_6.3.9600.22774_none_599e604bf64ceda2.manifest)
>
> [Windows Server 2012 R2 Components Registry Key KB5065507](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/blob/main/2025_09/Server_2012_R2_x64_ComponentsRegistryKey.reg)
>
> [Windows Server 2012 R2 SideBySide Registry Key KB5065507](https://github.com/HackAndPwn/Windows-8.1-And-Server-2012-R2-ESU-Analysis/blob/main/2025_09/Server_2012_R2_x64_SideBySideRegistryKey_x64.reg)

### Update 2025-09-17
* Replaced Windows Server 2012 R2 May 2025 Servicing Stack Update (KB5058529) with September 2025 Servicing Stack Update (KB5065767).
* Replaced Windows Server 2012 R2 August 2025 Monthly Update (KB5063950) with September 2025 Monthly Update (KB5065507).
* Replaced Windows Server 2012 R2 July 2025 .NET Framework 4.8 Update (KB5062157) with September 2025 .NET Framework 4.8 Update (KB5065752).
* Replaced Windows Server 2012 R2 August 2025 Manifest, Components Registry Key, and SideBySide Registry Key (6.3.9600.22725) with September 2025 (6.3.9600.22774).
* Updated MicRooCerAut_2010-06-23.crl.
* Updated Microsoft ECC Product Root Certificate Authority 2018.crl.
* Updated Microsoft ECC TS Root Certificate Authority 2018.crl.
* Updated Microsoft EV ECC Root Certificate Authority 2017.crl.
* Updated Microsoft EV RSA Root Certificate Authority 2017.crl.

For previous updates to this post, see [Windows 8.1 and Windows Server 2012 R2 ESU Analysis Changelog](https://hackandpwn.com/windows-8.1-and-2012-r2-esu-analysis-changelog/).